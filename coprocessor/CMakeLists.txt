# Project definitions
# 
project(coprocessor)
version("3.0.0")

# 
# Libraries
# 
# special case - this is an autogenerated file
set(VERSION_CC ${CMAKE_CURRENT_SOURCE_DIR}/version.cc)
set(LIB_SOURCES
    BoundedVariableElimination.cc
    BoundedVariableEliminationParallel.cc
    Bva.cc
    CP3Config.cc
    Circuit.cc
    ClauseElimination.cc
    Coprocessor.cc
    Dense.cc
    Entailed.cc
    EquivalenceElimination.cc
    Experimental.cc
    FourierMotzkin.cc
    HiddenTautologyElimination.cc
    LiteralAddition.cc
    OutputFormula.cc
    Probing.cc
    Propagation.cc
    Resolving.cc
    Rewriter.cc
    Shuffler.cc
    Subsumption.cc
    Symmetry.cc
    TwoSAT.cc
    Unhiding.cc
    bce.cc
    libcoprocessorc.cc
    rate.cc
    sls.cc
    xor.cc
    ${VERSION_CC})

add_library(${PROJECT_NAME}-lib-static STATIC ${LIB_SOURCES})
add_library(${PROJECT_NAME}-lib-shared SHARED ${LIB_SOURCES})
add_library(${PROJECT_NAME}-lib-object OBJECT ${LIB_SOURCES})

set_target_properties(${PROJECT_NAME}-lib-static PROPERTIES
                                                 OUTPUT_NAME "${PROJECT_NAME}")
set_target_properties(${PROJECT_NAME}-lib-shared PROPERTIES
                                                 OUTPUT_NAME "${PROJECT_NAME}" 
                                                 VERSION ${VERSION}
                                                 SOVERSION ${SOVERSION})

git_signature(PROJECT_NAME ${PROJECT_NAME}
              SCRIPT ${CMAKE_CURRENT_SOURCE_DIR}/version.cmake
              DESTINATION ${VERSION_CC}
              VERSION ${VERSION})

# 
# Executables
# 
add_executable(${PROJECT_NAME} Main.cc)

if(STATIC_BINARIES)
  target_link_libraries(${PROJECT_NAME} riss-lib-static ${PROJECT_NAME}-lib-static)
else()
  target_link_libraries(${PROJECT_NAME} riss-lib-shared ${PROJECT_NAME}-lib-shared)
endif()

# 
# Installation
# 
install(TARGETS ${PROJECT_NAME}-lib-static ${PROJECT_NAME}-lib-shared ${PROJECT_NAME}
        RUNTIME DESTINATION bin
        LIBRARY DESTINATION lib
        ARCHIVE DESTINATION lib)

install(DIRECTORY ${PROJECT_NAME}
        DESTINATION include/${PROJECT_NAME}
        FILES_MATCHING PATTERN "*.h")
